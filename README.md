
# Chatbot API with FastAPI, OpenAI, Redis, and Celery

This project is a scalable chatbot API built with **FastAPI**, integrated with **OpenAI's GPT API** for chat responses. The API features user authentication, chat threads with history tracking, caching with **Redis**, and background task handling with **Celery**.

---

## Features

- **User Authentication**: Register, login, and secure access to chat features.
- **Chat Thread Management**:
  - Start new chats with autogenerated titles and thread IDs.
  - Continue previous chats with history remembered.
  - Delete specific chats by thread ID.
- **OpenAI GPT Integration**: Generate real-time, streamed chat responses.
- **Caching**: Improve performance with Redis for storing recent responses.
- **Background Tasks**: Log interactions asynchronously with Celery.
- **Database**: Persistent storage of users, chat threads, and messages using PostgreSQL.

---

## Requirements

- Python 3.8+
- PostgreSQL
- Redis
- RabbitMQ (for Celery)

---

## Installation

### 1. Clone the Repository

```bash
git clone https://github.com/yourusername/chatbot-api.git
cd chatbot-api
```

### 2. Set Up a Virtual Environment

```bash
python3 -m venv venv
source venv/bin/activate
```

### 3. Install Dependencies

```bash
pip install -r requirements.txt
```

### 4. Configure Environment Variables

Create a `.env` file and add the following:

```env
DATABASE_URL=postgresql://user:password@localhost:5432/chatbot
REDIS_URL=redis://localhost:6379/0
CELERY_BROKER_URL=pyamqp://guest@localhost//
OPENAI_API_KEY=your_openai_api_key
SECRET_KEY=your_secret_key
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
```

Replace placeholders with your actual values.

---

## Running the Application

### 1. Set Up the Database

```bash
alembic upgrade head
```

### 2. Start Redis and RabbitMQ

```bash
# Start Redis
redis-server

# Start RabbitMQ
rabbitmq-server
```

### 3. Run Celery Worker

```bash
celery -A app.queue.celery_app worker --loglevel=info
```

### 4. Start the FastAPI Server

```bash
uvicorn app.main:app --reload
```

---

## API Endpoints

### Authentication

- **POST `/api/v1/auth/register`**: Register a new user.
- **POST `/api/v1/auth/login`**: Log in and get an access token.

### Chat Management

- **POST `/api/v1/chatbot/new`**: Start a new chat.
- **POST `/api/v1/chatbot/{thread_id}`**: Continue a chat.
- **DELETE `/api/v1/chatbot/{thread_id}`**: Delete a specific chat.

---

## Project Structure

```
chatbot-api/
├── app/
│   ├── auth/
│   ├── chatbot/
│   ├── config/
│   ├── database.py
│   ├── models.py
│   ├── queue/
│   ├── redis_cache.py
│   ├── routers/
│   ├── schemas/
│   ├── services/
│   ├── tasks.py
├── migrations/
├── .env
├── requirements.txt
├── README.md
```

---

## Technologies Used

- **FastAPI**: Web framework.
- **OpenAI**: GPT integration.
- **SQLAlchemy**: ORM for database interactions.
- **Redis**: In-memory data store for caching.
- **Celery**: Task queue for background processing.
- **Alembic**: Database migrations.

---

## Contributing

1. Fork the repository.
2. Create a feature branch: `git checkout -b feature-name`.
3. Commit changes: `git commit -m "Description"`.
4. Push to the branch: `git push origin feature-name`.
5. Submit a pull request.

---

## License

This project is licensed under the MIT License.

---

## Contact

For any inquiries, feel free to reach out:

- **Name**: Muhammed Yuguda
- **Email**: elemenx93@gmail.com
- **Location**: Lagos, Nigeria
